# ??? 设置菜单完成！

## ? 已完成的功能

### 1. 设置菜单界面 ?
- 原版互动模式开关
- RimTalk AI 模式开关  
- AI 自动触发开关
- 饥饿阈值滑块 (30% - 80%)
- 冷却时间滑块 (1 - 8 小时)
- 恢复默认设置按钮

### 2. 代码集成 ?
所有功能模块已更新以使用设置：
- ? `JobGiver_SocialDine` - 使用饥饿阈值和冷却时间
- ? `ThinkNode_ConditionalCanSocialDine` - 使用饥饿阈值
- ? `FoodSharingUtility` - 使用饥饿阈值
- ? `InteractionWorker_OfferFood` - 检查原版模式开关
- ? `AIIntentHandler` - 检查 RimTalk 模式开关

### 3. 翻译文件 ?
- ? 中文翻译 (`Languages/ChineseSimplified/Keyed/SocialDining_Keys.xml`)
- ? 英文翻译 (`Languages/English/Keyed/SocialDining_Keys.xml`)

---

## ?? 如何访问设置

### 在游戏中：
```
主菜单 → 选项 (Options) → Mod 设置 (Mod Settings) → RimTalk Social Dining
```

---

## ?? 设置选项说明

### 1. 触发模式选择

#### 原版互动方式
```
状态: 默认启用
功能: 允许通过原版社交菜单主动邀请他人共餐
操作: 右键点击殖民者 → 社交 → 提供食物
```

#### RimTalk AI 方式  
```
状态: 默认禁用
功能: RimTalk AI 根据对话内容智能触发共餐
要求: 需要安装 RimTalk 核心 Mod
```

**提示：** 两种模式可以同时启用！

---

### 2. AI 自动触发设置

#### 启用 AI 自动触发
```
状态: 默认启用
功能: 殖民者饥饿时自动寻找伙伴共餐
说明: 无需玩家手动操作，AI 会自动判断并触发
```

#### 饥饿阈值
```
默认值: 50%
范围: 30% - 80%
说明: 只有当食物条低于此百分比时才会触发共餐
建议: 50% (平衡频率)
       30% (更频繁触发)
       70% (减少触发)
```

#### 冷却时间
```
默认值: 2 小时
范围: 1 - 8 小时
说明: 同一对殖民者完成共餐后，需要等待多久才能再次共餐
建议: 2 小时 (平衡频率)
       1 小时 (更频繁)
       4+ 小时 (减少频率)
```

---

## ?? 推荐配置

### 配置 A: 平衡模式（默认）
```
原版互动: ? 启用
RimTalk AI: ? 禁用（除非安装了 RimTalk）
AI 自动触发: ? 启用
饥饿阈值: 50%
冷却时间: 2 小时

适合: 大多数玩家，平衡的触发频率
```

### 配置 B: 高频模式
```
原版互动: ? 启用
RimTalk AI: ? 启用（如果有）
AI 自动触发: ? 启用
饥饿阈值: 30%
冷却时间: 1 小时

适合: 喜欢频繁社交互动的玩家
```

### 配置 C: 低频模式
```
原版互动: ? 启用
RimTalk AI: ? 禁用
AI 自动触发: ? 启用
饥饿阈值: 70%
冷却时间: 4 小时

适合: 喜欢轻度社交的玩家
```

### 配置 D: 手动模式
```
原版互动: ? 启用
RimTalk AI: ? 禁用
AI 自动触发: ? 禁用
饥饿阈值: 不适用
冷却时间: 不适用

适合: 完全手动控制的玩家
```

---

## ?? 故障排查

### 问题 1: 设置菜单不显示
**原因:** Mod 未正确加载  
**解决:** 重启游戏，确认 Mod 已启用

### 问题 2: 更改设置后没有效果
**原因:** 设置需要保存  
**解决:** 关闭设置窗口会自动保存，然后生效

### 问题 3: 触发过于频繁
**解决:** 
- 提高饥饿阈值到 60-70%
- 增加冷却时间到 3-4 小时

### 问题 4: 从不触发
**检查:**
- AI 自动触发是否启用
- 殖民者是否足够饥饿
- 是否有可用的伙伴
- 是否有可用的食物

---

## ?? 参数影响

### 饥饿阈值对比
| 阈值 | 触发时机 | 频率 |
|------|---------|------|
| 30% | 食物条 < 70% | 很频繁 |
| 50% | 食物条 < 50% | 平衡 ? |
| 70% | 食物条 < 30% | 较少 |
| 80% | 食物条 < 20% | 很少 |

### 冷却时间对比
| 时长 | 游戏刻数 | 效果 |
|------|---------|------|
| 1 小时 | 2500 | 频繁触发 |
| 2 小时 | 5000 | 平衡 ? |
| 4 小时 | 10000 | 适度触发 |
| 8 小时 | 20000 | 很少触发 |

---

## ?? 界面预览

### 设置窗口包含：
```
┌─────────────────────────────────────────┐
│   社交共餐设置                           │
├─────────────────────────────────────────┤
│ 触发模式选择                             │
│ ? 启用原版互动方式                       │
│ ? 启用 RimTalk AI 方式                   │
├─────────────────────────────────────────┤
│ AI 自动触发设置                          │
│ ? 启用 AI 自动触发共餐                   │
│                                          │
│ 饥饿阈值: 50%                            │
│ ━━━━━●━━━━━━━━━                         │
│ 只有当食物条低于此百分比时才会触发共餐    │
│                                          │
│ 冷却时间: 2 小时                         │
│ ━━●━━━━━━━━━━━━                         │
│ 同一对殖民者完成共餐后的等待时间          │
├─────────────────────────────────────────┤
│ 功能说明                                 │
│ ? 原版互动方式：右键点击殖民者 → 社交...  │
│ ? RimTalk AI 方式：AI 根据对话自动触发... │
│ ? AI 自动触发：殖民者自动寻找伙伴...       │
├─────────────────────────────────────────┤
│           [恢复默认设置]                  │
└─────────────────────────────────────────┘
```

---

## ?? 设置保存

设置会自动保存到：
```
RimWorld/Config/ModSettings.xml
```

卸载 Mod 后设置不会丢失，重新安装 Mod 会保留之前的设置。

---

## ?? 设置菜单完成！

现在您可以：
- ? 在游戏中轻松调整触发频率
- ? 切换不同的触发模式
- ? 根据自己的游戏风格自定义体验
- ? 随时恢复默认设置

**重启游戏后，打开 Mod 设置即可看到新的设置界面！** ???
